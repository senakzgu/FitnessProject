@model FitnessApp.Models.ViewModels.TrainerEditViewModel

<h1>Create Trainer</h1>

<form asp-action="Create">

    <!-- Eğitmen Bilgileri -->
    <div class="form-group">
        <label asp-for="Trainer.Name"></label>
        <input asp-for="Trainer.Name" class="form-control" />
    </div>

    <div class="form-group">
        <label asp-for="Trainer.Specialty"></label>
        <input asp-for="Trainer.Specialty" class="form-control" />
    </div>

    <div class="form-group">
        <label asp-for="Trainer.WorkingHours"></label>
        <input asp-for="Trainer.WorkingHours" class="form-control" placeholder="08:00-18:00" />
    </div>

    <!-- SALON SEÇ -->
    <div class="form-group">
        <label asp-for="Trainer.GymId"></label>
        <select asp-for="Trainer.GymId" id="GymId" class="form-control" asp-items="ViewBag.GymId">
            <option value="">Salon seçiniz</option>
        </select>
    </div>

    <!-- DİNAMİK HİZMET LİSTESİ -->
    <h4>Bu eğitmenin verebileceği hizmetler</h4>

    <div id="services-area">
        <p>Önce salon seçiniz</p>
    </div>

    <button type="submit" class="btn btn-primary mt-3">Kaydet</button>
</form>

@section Scripts {
<script>
document.getElementById("GymId").addEventListener("change", function () {
    const gymId = this.value;
    const area = document.getElementById("services-area");

    if (!gymId) {
        area.innerHTML = "<p>Önce salon seçiniz</p>";
        return;
    }

    fetch(`/Services/GetServicesByGym?gymId=${gymId}`)
        .then(res => res.json())
        .then(list => {
            if (list.length === 0) {
                area.innerHTML = "<p>Bu salonda hizmet tanımlı değil.</p>";
                return;
            }

            let html = "<ul class='list-group'>";
            list.forEach(s => {
                html += `
                    <li class="list-group-item">
                        <input type="checkbox" name="SelectedServiceIds" value="${s.id}" />
                        ${s.name}
                    </li>
                `;
            });
            html += "</ul>";

            area.innerHTML = html;
        });
});
</script>
}
